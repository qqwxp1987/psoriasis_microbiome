# Psoriasis Gut Metagenome Analysis

Analysis scripts and data for the manuscript: *"Disentangling Environmental and Disease-Specific Signatures in the Gut Microbiome of Psoriasis: Discovery of Fimenecus sp. as a Novel Biomarker and Characterization of the Gut Virome"*

## Directory Structure

```
psoriasis_microbiome/
├── README.md
├── scripts/
│   ├── 01_Alpha_Diversity.R          # Shannon & Pielou indices, MaAsLin2
│   ├── 02_Beta_Diversity.R           # PERMANOVA, JSD, Bray-Curtis distances
│   ├── 03_Network_Analysis.R         # Co-occurrence networks (ggClusterNet)
│   ├── 04_Differential_Abundance.R   # LEfSe, LinDA, MaAsLin2 (species/KO/Pathway)
│   ├── 05_RandomForest_Classifier.R  # Boruta + RF, ROC/PRC, confusion matrix
│   ├── 06_Prevalence_OddsRatio.R     # Prevalence, Fisher test, OR, waffle chart
│   ├── 07_Genomic_Annotation.R       # KEGG enrichment, EggNOG-mapper barplot
│   └── 08_Correlation_Analysis.R     # Partial Spearman correlation (ppcor)
├── data/
│   ├── metadata.txt
│   ├── humann/
│   │   ├── filter_ko_relab.tsv
│   │   └── filter_path_relab.tsv
│   └── metaphlan/
│       ├── MicrobiomeData.rds
│       └── phyloseq_taxa.rds
└── outputs/                           # Analysis results generated by scripts
    ├── alpha_diversity/
    ├── beta_diversity/
    ├── differential_abundance/
    └── network_igraph/
        ├── 143_3grp/
        └── 28pairs_2grp/
```

## Prerequisites

### R (≥ 4.2)

```r
# CRAN packages
install.packages(c(
  "here", "dplyr", "ggplot2", "patchwork", "gghalves", "vegan",
  "mice", "reshape2", "ppcor", "caret", "Boruta", "pROC", "ROCR",
  "ggpubr", "rstatix", "waffle", "emmeans", "rio", "tidyr",
  "scales", "ggsci", "igraph", "sna", "tidyfst", "ggnewscale",
  "ggstance", "stringr"
))

# Bioconductor packages
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install(c(
  "phyloseq", "microbiomeMarker", "MicrobiomeStat", "Maaslin2",
  "microbiome", "MicrobiomeProfiler"
))

# GitHub packages
devtools::install_github("taowenmicro/ggClusterNet")
```
